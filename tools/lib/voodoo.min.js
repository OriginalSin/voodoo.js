'use strict';var g=!0,h=null,m=!1;function x(){return function(){}}function ea(f){return function(){return this[f]}}
(function(f,y){function $(){function w(a){this.lc=a||"voodoo";this.ad="["+this.lc+"]"}function I(a,b){this.width=a;this.height=b}function J(a,b){this.x=a;this.y=b}function fa(){this.qc=this.Pb=this.Ob=m;Object.defineProperty(this,"disableStencils",{get:ea("Ob"),set:function(a){this.Ob=a;f.voodoo.engine.fc()},enumerable:g});Object.defineProperty(this,"drawStencils",{get:ea("Pb"),set:function(a){this.Pb=a;f.voodoo.engine.fc()},enumerable:g});Object.defineProperty(this,"showFps",{get:ea("qc"),set:function(a){this.qc=
a},enumerable:g})}function M(){this.Fb={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",
darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",
goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",
lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",
olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",
slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}}function F(){var a=this.extendableMethodStack,b;for(b in a)if(a.hasOwnProperty(b)){var c=a[b];this[b]===c.ca[c.J]&&--c.J}this.base.Rc=this;this.construct.apply(this,arguments)}function Z(a){d.a(a,"objects must be valid.","(Composite_::Composite_)");
d.a(0<a.length,"objects must not be empty.","(Composite_::Composite_)");var b=a[0],c=this,e;for(e in b)try{"function"===typeof b[e]&&(c[e]=function(a,b){return function(){for(var e,d=0,r=b.length;d<r;++d)e=b[d],e=e[a].apply(e,arguments);return e===b[b.length-1]?c:e}}(e,a))}catch(r){}}function z(a,b,c,e,r,l){d.a(a,"pass must be valid.",a,"(Layer_::Layer_)");d.a(b===E.ThreeJs,"Only ThreeJs is supported.",b,"(Layer_::Layer_)");d.a(c,"camera must be valid.","(Layer_::Layer_)");d.a(e,"sceneFactory must be valid.",
"(Layer_::Layer_)");d.a(r,"triggersFactory must be valid.","(Layer_::Layer_)");this.jc=a;this.h=b;this.c=c;this.oc=e;this.za=r;this.Db=l;this.Q=[]}function K(a){d.a(a,"cache must be valid.","(Cache::Cache)");this.N=a}function N(){d.j("Creating Cache Factory");this.N={}}function aa(){this.ha=m;this.qb=this.bb=0;this.O=y.createElement("div");var a=this.O.style;a.position="fixed";a.zIndex=999999999;a.left="0px";a.top="0px";a.backgroundColor="black";a.color="lime";a.fontStyle="bold";a.fontSize="200%";
a.fontFamily="sans-serif";this.O.display="none";var b=this;this.Kc=setInterval(function(){b.cb=b.bb;b.gd=b.qb;b.bb=0;b.qb=0},1E3)}function O(){}function B(){}function $(){}function C(){}function ba(a){d.a(a,"element must be valid.","(TrackedElement_::TrackedElement_)");this.Ea=a;this.Tc=0;this.ia={};this.Ja=this.Ka=this.Ma=this.La=Number.MIN_VALUE;this.n()}function ga(){d.j("Creating Tracker");this.xa={};this.Uc=this.Vc=0;this.xb={}}function P(){this.ka={};this.ib=0}function Q(a,b,c,e){d.a(a,"view must be valid.",
"(EventTrigger_::EventTrigger_)");d.a(b,"object must be valid.","(EventTrigger_::EventTrigger_)");d.a(c,"parent must be valid.","(EventTrigger_::EventTrigger_)");this.t=a;this.da=b;this.Va="undefined"===typeof e?-1:e;this.m=c;this.l=a.model}function X(){}function ia(){}function ja(){}function G(a){d.a(a,"engine must be valid.","(MouseDetector_::MouseDetector_)");this.f=a;this.Wb();this.f.sa.tb(new J(0,0));this.xc();var b=this;this.f.on("removemodel",function(a){b.k&&a.model===b.k.l&&(b.k=h);if(b.T)for(var e=
0;3>e;++e){var d=b.T[e];d&&a.model===d.l&&(b.T[e]=h)}if(b.aa)for(e=0;3>e;++e)(d=b.aa[e])&&a.model===d.l&&(b.aa[e]=h)})}function A(a,b,c,e){d.j("Creating ThreeJs Camera");d.a(a,"canvas must be valid.","(ThreeJsCamera_::ThreeJsCamera_)");d.a("undefined"!==typeof b,"fov must be valid.",b,"(ThreeJsCamera_::ThreeJsCamera_)");d.a("number"===typeof b,"fov must be a number.",b,"(ThreeJsCamera_::ThreeJsCamera_)");d.a(0<=b,"fov must be greater than or equal to 0.",b,"(ThreeJsCamera_::ThreeJsCamera_)");d.a(c,
"zNear must be valid.",c,"(ThreeJsCamera_::ThreeJsCamera_)");d.a("number"===typeof c,"zNear must be a number.",c,"(ThreeJsCamera_::ThreeJsCamera_)");d.a(0<c,"zNear must be greater than 0.",c,"(ThreeJsCamera_::ThreeJsCamera_)");d.a(e,"zFar must be valid.",e,"(ThreeJsCamera_::ThreeJsCamera_)");d.a("number"===typeof e,"zFar must be a number.",e,"(ThreeJsCamera_::ThreeJsCamera_)");d.a(0<e,"zFar must be greater than 0.",e,"(ThreeJsCamera_::ThreeJsCamera_)");d.a(c<e,"zNear must be less than zFar.",c,e,
"(ThreeJsCamera_::ThreeJsCamera_)");this.c=new THREE.Camera;this.eb=new THREE.Frustum;this.Eb=a;this.Ub=b;this.L=c;this.R=e;this.Qc();this.Ic()}function R(a){d.a(a,"Engine must be defined.","(ThreeJsRaycaster_::ThreeJsRaycaster_)");d.a(a.h,"Renderer must be defined.","(ThreeJsRaycaster_::ThreeJsRaycaster_)");this.f=a;this.h=a.h;this.mc=new THREE.Projector}function D(a,b){d.a(a,"scene must be valid.","(ThreeJsScene_::ThreeJsScene_)");d.a(b,"view must be valid.","(ThreeJsScene_::ThreeJsScene_)");this.i=
a;this.t=b;this.fa=f.voodoo.engine.fa;this.wa=h;this.m=new THREE.Object3D;this.i.add(this.m);this.pa=[];this.oa=[];this.d=new P;var c=this;Object.defineProperty(this,"objects",{get:function(){for(var a=[],b=c.m.children,d=0,f=b.length;d<f;++d){var n=b[d];n.addedToVoodooScene&&a.push(n)}return a},enumerable:g})}function L(){d.j("Creating ThreeJs Scene Factory");this.i=new THREE.Scene}function ca(a,b,c){d.a(a,"triggers must be valid.","(ThreeJsTriggers_::ThreeJsTriggers_)");d.a(b,"scene must be valid.",
"(ThreeJsTriggers_::ThreeJsTriggers_)");d.a(c,"view must be valid.","(ThreeJsTriggers_::ThreeJsTriggers_)");this.p=a;this.i=b;this.t=c}function S(){d.j("Creating ThreeJs Triggers Factory");this.p=[]}function t(a){d.a(a,"engine must be valid.","(ThreeJsRenderer_::ThreeJsRenderer_)");this.f=a;this.ba=[];this.vd();this.Gc();this.Hc();this.bd();this.ma=new aa;this.fb=new Date;this.kc=m}function v(a){a=new k(a);d.a(a.renderer===E.ThreeJs,"Only ThreeJs is supported.","(Engine::Engine)");d.j("Creating Engine");
d.j("   version: 0.9.0.min");d.j("   userAgent: "+navigator.userAgent);for(var b in a)a.hasOwnProperty(b)&&d.j("   options."+b+": "+a[b]);f.WebGLRenderingContext||d.B("WebGL not supported.","(Engine::Engine)");this.e=a;this.wd();this.gb=new N;this.fa=new ga;this.K=[];var c=this;Object.defineProperty(this,"models",{get:function(){return c.K.slice(0)},enumerable:g});this.nd();switch(a.renderer){case E.ThreeJs:this.h=new t(this);this.sa=new R(this);break;default:this.sa=this.h=h,d.B("Unsupported renderer",
"(Engine::Engine)")}this.d=new P;this.Oa=new G(this);f.voodoo.engine=this;a.standardLighting&&(d.j("Creating standard lights"),new ka({color:"white"}),new ha({color:"white"}));this.Ta=this.Ua=this.Wa=-1;b=0===this.e.updateInterval;var e=0===this.e.renderInterval;a.frameLoop&&(d.j("Beginning frame loop"),(b||e)&&this.nc(b,e),b||(this.Wa=f.setInterval(function(){c.n()},this.e.updateInterval)),e||(this.Ua=f.setInterval(function(){c.h.W()},this.e.renderInterval)))}function k(a){d.j("Creating Options");
if(a)for(var b in a)this[b]=a[b]}w.prototype.Sc=function(a){var b=Array.prototype.slice.call(arguments);b.unshift(this.ad);f.console.log(b.join(" "))};w.prototype.j=function(a){this.Sc.apply(this,arguments)};w.prototype.l=function(a,b){var c=Array.prototype.slice.call(arguments,1);c.unshift(a.privateModelProperties.id);this.j.apply(this,c)};w.prototype.B=function(a){var b=Array.prototype.slice.call(arguments);b.unshift("**ERROR**");throw{name:this.lc+" exception",message:b.join(" "),toString:function(){return this.name+
": "+this.message}};};w.prototype.a=function(a,b){if(!a){var c=Array.prototype.slice.call(arguments,1);c.unshift("Assert failed:");this.B.apply(this,c)}};var d=new w("voodoo");I.prototype.width=0;I.prototype.height=0;J.prototype.x=0;J.prototype.y=0;fa.prototype.disableStencils=m;fa.prototype.drawStencils=m;fa.prototype.showFps=m;this.debug=new fa;M.prototype.convertCssColorToThreeJsColor=function(a){d.a(a,"cssColor undefined.","(Utility::convertCssColorToThreeJsColor)");d.a(3<=a.length,"cssColor too short.",
"(Utility::convertCssColorToThreeJsColor)");a=a.toLowerCase();return"#"===a[0]?this.Hb(a):0===a.indexOf("rgb(")?(a=a.substring(4,a.length-1).split(","),d.a(3===a.length,"Invalid rgb color.","(Utility::convertCssColorToThreeJsColor)"),this.Ib(a[0],a[1],a[2])):0===a.indexOf("rgba(")?(a=a.substring(5,a.length-1).split(","),d.a(4===a.length,"Invalid rgba color.","(Utility::convertCssColorToThreeJsColor)"),this.Ib(a[0],a[1],a[2])):0===a.indexOf("hsl(")?(a=a.substring(4,a.length-1).split(","),d.a(3===a.length,
"Invalid hsl color.","(Utility::convertCssColorToThreeJsColor)"),this.Gb(a[0],a[1],a[2])):0===a.indexOf("hsla(")?(a=a.substring(5,a.length-1).split(","),d.a(4===a.length,"Invalid hsla color.","(Utility::convertCssColorToThreeJsColor)"),this.Gb(a[0],a[1],a[2])):this.Fc(a)};M.prototype.findAbsolutePosition=function(a){var b=0,c=0;if(a.offsetParent){do b+=a.offsetLeft,c+=a.offsetTop;while(a=a.offsetParent)}return{x:b,y:c}};M.prototype.Hb=function(a){return new THREE.Color(parseInt("0x"+a.substring(1),
16))};M.prototype.Ib=function(a,b,c){a=parseFloat(a)/255;b=parseFloat(b)/255;c=parseFloat(c)/255;d.a(0<=a,"r value < 0.","(Utility::convertRGBColorToThreeJsColor_)");d.a(1>=a,"r value > 1.","(Utility::convertRGBColorToThreeJsColor_)");d.a(0<=b,"g value < 0.","(Utility::convertRGBColorToThreeJsColor_)");d.a(1>=b,"g value > 1.","(Utility::convertRGBColorToThreeJsColor_)");d.a(0<=c,"b value < 0.","(Utility::convertRGBColorToThreeJsColor_)");d.a(1>=c,"b value > 1.","(Utility::convertRGBColorToThreeJsColor_)");
return(new THREE.Color).setRGB(a,b,c)};M.prototype.Gb=function(a,b,c){a=parseFloat(a);b=parseFloat(b)/100;c=parseFloat(c)/100;d.a(0<=a,"h value < 0.","(Utility::convertHSLColorToThreeJsColor_)");d.a(360>a,"h value >= 360.","(Utility::convertHSLColorToThreeJsColor_)");d.a(0<=b,"s value < 0.","(Utility::convertHSLColorToThreeJsColor_)");d.a(1>=b,"s value > 1.","(Utility::convertHSLColorToThreeJsColor_)");d.a(0<=c,"l value < 0.","(Utility::convertHSLColorToThreeJsColor_)");d.a(1>=c,"l value > 1.","(Utility::convertHSLColorToThreeJsColor_)");
b*=1-Math.abs(2*c-1);var e=a/60,r=b*(1-Math.abs(parseInt(e,10)%2-1)),l=a=0,f=0;0<=e&&1>e?(a=b,l=r):1<=e&&2>e?(a=r,l=b):2<=e&&3>e?(l=b,f=r):3<=e&&4>e?(l=r,f=b):4<=e&&5>e?(a=r,f=b):5<=e&&6>e&&(a=b,f=r);c-=0.5*b;return(new THREE.Color).setRGB(a+c,l+c,f+c)};M.prototype.Fc=function(a){d.a(a in this.Fb,"Invalid color string.","(Utility::convertColorStringToThreeJsColor_)");return this.Hb(this.Fb[a.toLowerCase()])};this.utility=new M;F.prototype.construct=function(){d.B("Extendable::construct not implemented",
"(Extendable::construct)")};F.prototype.base={};F.extend=function(a){function b(){F.apply(this,arguments)}function c(a,b,c){var d=a[b];d||(d=a[b]={ca:[],J:-1});a=d.ca;a[d.J]!==c&&(a.push(c),++d.J)}function e(){var a=l.base={},b;for(b in u)if(u.hasOwnProperty(b)){var c=u[b];a[b]=function(a,b,c){return function(){if(0<=b.J){var d=b.J--;try{var e=c[d].apply(a.Rc,arguments)}catch(r){throw b.J=b.ca.length-1,r;}++b.J;return e}}}(a,c,c.ca)}}b.extend=F.extend;var d=this.prototype,l=b.prototype,f;for(f in d)d.hasOwnProperty(f)&&
(l[f]=d[f]);var n=d.extendableMethodStack,u=l.extendableMethodStack={},s;for(s in n)if(n.hasOwnProperty(s)){var k=n[s];u[s]={ca:k.ca.slice(0),J:k.J}}for(s in d)n=d[s],"function"===typeof n&&d.hasOwnProperty(s)&&c(u,s,n);if(!a)return e(),b;"function"===typeof a&&(a=a.prototype);if(d=a.extendableMethodStack)for(s in d)if(d.hasOwnProperty(s))for(var n=d[s].ca,k=0,q=n.length;k<q;++k)c(u,s,n[k]);for(f in a)a.hasOwnProperty(f)&&(s=a[f],s!==d&&("function"===typeof s&&c(u,f,s),l[f]=s));e();return b};this.Extendable=
F;var H={Above:1,Below:2,BelowStencil:3,Seam:4,SeamStencil:5};z.prototype.zc=function(a){d.a(a,"view must be valid.","(Layer_::addView_)");this.Q.push(a)};z.prototype.ja=function(){for(var a=0,b=this.Q.length;a<b;++a)this.Q[a].scene.H=m};z.prototype.U=function(){for(var a=this.c.eb,b=0,c=this.Q.length;b<c;++b){var d=this.Q[b],r=d.scene;if(d.loaded&&r.H){d=r.oa;if(d.length!==r.pa.length)return g;for(var r=0,f=d.length;r<f;++r){var k=d[r];if(k.geometry&&(k.updateMatrixWorld(g),a.intersectsObject(k)))return g}}}return m};
z.prototype.fd=function(a){a=this.Q.indexOf(a);d.a(-1!==a,"View not found.","(Layer_::removeView_)");this.Q.splice(a,1)};z.prototype.Db=h;z.prototype.c=h;z.prototype.jc=h;z.prototype.h=h;z.prototype.oc=h;z.prototype.za=h;z.prototype.Q=h;K.prototype["delete"]=function(a,b,c){d.a(a,"key must be valid.","(Cache::delete)");delete this.Fa(b,c)[a]};K.prototype.get=function(a,b,c){d.a(a,"key must be valid.","(Cache::get)");return this.Fa(b,c)[a]};K.prototype.has=function(a,b,c){d.a(a,"key must be valid.",
"(Cache::has)");return this.Fa(b,c).hasOwnProperty(a)};K.prototype.set=function(a,b,c,e){d.a(a,"key must be valid.","(Cache::set)");this.Fa(c,e)[a]=b};K.prototype.Fa=function(a,b){var c,d;a?(c=a,d=b||"*"):(c=this.gc,d=this.hc);this.N.hasOwnProperty(d)||(this.N[d]={});d=this.N[d];d.hasOwnProperty(c)||(d[c]={});return d[c]};K.prototype.gc="";K.prototype.hc="";N.prototype.Jb=function(a){d.a(a,"model must be valid.","(CacheFactory_::createCache_)");var b=new K(this.N);b.gc=a.name;b.hc=a.organization;
return b};var da=0,q=F.extend();q.prototype.cleanUp=function(){var a=this.base.cleanUp;"function"===typeof a&&a()};q.prototype.construct=function(a){d.a(this.name,"Model type name must be valid.","(Model::Model)");d.a(this.viewType,"Model view type must be valid.","(Model::Model)");!this.viewType.prototype.above&&!this.viewType.prototype.below&&d.B("View must exist on at least one layer.","(Model::Model)");this.stencilViewType=this.stencilViewType||this.viewType;var b=this.privateModelProperties=
{},c="<"+ ++da+",";"*"!==this.organization&&(c+=this.organization+".");c+=this.name+">";b.id=c;d.l(this,"Constructing");c=f.voodoo;c.engine||(c.engine=new v(new k));c=c.engine;b.d=new P;var e=b.N=c.gb.Jb(this);Object.defineProperty(this,"cache",{get:function(){return e},enumerable:g});this.initialize(a||{});a=b.Q=[];var r=b.zd=[];b.Pa=0;b.Qa=0;Object.defineProperty(this,"loaded",{get:function(){return b.Pa===b.Qa},enumerable:g});for(var l=this.stencilViewType===this.viewType,W=this.viewType.prototype,
n=W.above,W=W.below,u=c.h.ba,s=0,q=u.length;s<q;++s){var t=u[s];switch(t.jc){case H.Above:n&&a.push(new this.viewType(this,t));break;case H.Below:W&&a.push(new this.viewType(this,t));break;case H.Seam:n&&a.push(new this.viewType(this,t));break;case H.BelowStencil:W&&(l?a.push(new this.viewType(this,t)):r.push(new this.stencilViewType(this,t)));break;case H.SeamStencil:W&&(l?a.push(new this.viewType(this,t)):r.push(new this.stencilViewType(this,t)))}}var l=a.length,n=r.length,p=b.t=1<l?new Z(a):a[0],
w=b.rc=1<n?new Z(r):r[0];b.Qa=l+n;Object.defineProperty(this,"view",{get:function(){return p},enumerable:g});Object.defineProperty(this,"stencilView",{get:function(){return w},enumerable:g});this.setUpViews();c.yc(this)};q.prototype.destroy=function(){d.l(this,"Destroying");var a=this.privateModelProperties,b=f.voodoo,c=new b.Event("destroy",this);a.d.A(this,c);this.tearDownViews();b.engine.ed(this);b=a.t;c=a.rc;b&&b.destroy&&b.destroy();c&&c.destroy&&c.destroy();this.cleanUp();a.d.s();a.d=h;a.t=
h;a.rc=h};q.prototype.dispatch=function(a){this.privateModelProperties.d.A(this,a);return this};q.prototype.initialize=function(a){var b=this.base.initialize;"function"===typeof b&&b(a)};q.prototype.off=function(a,b){this.privateModelProperties.d.jb(a,b);return this};q.prototype.on=function(a,b){var c=this.privateModelProperties;c.d.kb(a,b);"load"===a&&c.Pa===c.Qa&&b.call(this,new f.voodoo.Event("load",this));return this};q.prototype.setUpViews=function(){var a=this.base.setUpViews;"function"===typeof a&&
a()};q.prototype.tearDownViews=function(){var a=this.base.tearDownViews;"function"===typeof a&&a()};q.prototype.update=function(a){var b=this.base.update;"function"===typeof b&&b(a)};q.prototype.cache=h;q.prototype.loaded=m;q.prototype.stencilView=h;q.prototype.view=h;q.prototype.onViewLoad=function(a){d.a(a,"view must be valid.","(Model::onViewLoad)");a=this.privateModelProperties;a.Pa++;if(a.Pa===a.Qa){var b=new f.voodoo.Event("load",this);a.d.A(this,b)}};q.prototype.name=h;q.prototype.organization=
"*";q.prototype.viewType=h;q.prototype.stencilViewType=h;q.extend=function(a){var b=F.extend.call(this,a),c=b.prototype,d=this.prototype,r=d.name,f=c.name;r&&(f&&f!==r)&&(c.name=r+"."+f);f=d.viewType;r=c.viewType;f&&(r&&f!==r)&&(c.viewType=f.extend(r));d=d.stencilViewType||f;a=("function"===typeof a?a.prototype:a)||{};a=a.stencilViewType||r;d&&(a&&d!==a)&&(c.stencilViewType=d.extend(a));b.extend=q.extend;return b};this.Model=q;var p=F.extend();p.prototype.construct=function(a,b){d.a(a,"model must be valid.",
"(View::construct)");d.a(b,"layer must be valid.","(View::construct)");var c=this.privateViewProperties={},e=this;Object.defineProperty(this,"cache",{get:function(){return c.N},enumerable:g});Object.defineProperty(this,"camera",{get:function(){return c.Na.c},enumerable:g});Object.defineProperty(this,"loaded",{get:function(){return c.Ha},set:function(a){c.Ha=a;if(c.Ha)c.l.onViewLoad(e)},enumerable:g});Object.defineProperty(this,"model",{get:function(){return c.l},enumerable:g});Object.defineProperty(this,
"renderer",{get:function(){return c.Na.h},enumerable:g});Object.defineProperty(this,"scene",{get:function(){return c.i},enumerable:g});Object.defineProperty(this,"triggers",{get:function(){return c.p},enumerable:g});c.l=a;c.Na=b;c.i=b.oc.Lb(this);c.p=b.za.Mb(this);c.N=b.Db.Jb(a);this.dirty();b.zc(this);c.Ha=g;this.load();if(c.Ha)a.onViewLoad(this)};p.prototype.destroy=function(){this.unload();var a=this.privateViewProperties;a.p.s();a.i.s();a.Na.fd(this);a.l=h;a.p=h;a.i=h;a.Na=h;a.N=h};p.prototype.dirty=
function(){this.privateViewProperties.i.H=g};p.prototype.load=function(){var a=this.base.load;"function"===typeof a&&a()};p.prototype.unload=function(){var a=this.base.unload;"function"===typeof a&&a()};p.prototype.above=g;p.prototype.below=g;p.prototype.cache=h;p.prototype.camera=h;p.prototype.loaded=h;p.prototype.model=h;p.prototype.renderer=h;p.prototype.scene=h;p.prototype.triggers=h;p.extend=function(a){a=F.extend.call(this,a);var b=a.prototype,c=this.prototype;this!==p&&(b.above=b.above||c.above,
b.below=b.below||c.below);a.extend=p.extend;return a};this.View=p;aa.prototype.s=function(){this.ha&&(this.O.display="none",y.body.removeChild(this.O),this.ha=m);f.clearInterval(this.Kc)};aa.prototype.Lc=function(){this.bb++;f.voodoo.debug.showFps?(this.ha||(this.O.display="block",y.body.appendChild(this.O),this.ha=g),this.O.innerHTML="Frames/second: "+this.cb+", Renders/second: "+this.gd):this.ha&&(this.O.display="none",y.body.removeChild(this.O),this.ha=m)};aa.prototype.W=function(){this.qb++};
aa.prototype.cb=0;O.prototype.position={};O.prototype.position.x=0;O.prototype.position.y=0;O.prototype.position.z=0;O.prototype.zNear=0;O.prototype.zFar=0;B.prototype.add=x();B.prototype.attach=x();B.prototype.detach=x();B.prototype.localToPage=function(){return{}};B.prototype.off=x();B.prototype.on=x();B.prototype.pageToLocal=function(){return{}};B.prototype.remove=x();B.prototype.objects=h;B.prototype.s=x();B.prototype.H=g;B.prototype.pa=h;B.prototype.oa=h;$.prototype.Lb=function(){d.B("createScene_() undefined.");
return h};var E={ThreeJs:0};this.Renderer=E;C.prototype.Za=x();C.prototype.s=x();C.prototype.ec=x();C.prototype.ic=x();C.prototype.W=x();C.prototype.sb=x();C.prototype.X=h;C.prototype.Z=h;C.prototype.$=h;C.prototype.ta=h;C.prototype.ua=h;C.prototype.yb=h;ba.prototype.wc=function(a){d.a(a,"callback must be valid.","(TrackedElement_::addCallback_)");d.a("function"===typeof a,"callback must be a function.","(TrackedElement_::addCallback_)");var b=this.Tc++;this.ia[b]=a;this.hb++;a(this.La,this.Ma,this.Ka,
this.Ja,g,g);return b};ba.prototype.cd=function(a){d.a(0<=a,"callbackId must be >= 0.",a,"(TrackedElement_::releaseCallback_)");d.a("number"===typeof a,"callbackId must be a number.",a,"(TrackedElement_::releaseCallback_)");delete this.ia[a];this.hb--};ba.prototype.n=function(){var a=f.voodoo.utility.findAbsolutePosition(this.Ea),b=this.Ea.offsetWidth,c=this.Ea.offsetHeight,d=a.x!==this.La||a.y!==this.Ma,r=b!==this.Ka||c!==this.Ja;if(d||r){this.La=a.x;this.Ma=a.y;this.Ka=b;this.Ja=c;for(var l in this.ia)this.ia.hasOwnProperty(l)&&
this.ia[l].call(h,this.La,this.Ma,this.Ka,this.Ja,d,r)}};ba.prototype.hb=0;ga.prototype.qd=function(a,b){d.a(a,"element must be valid.","(Tracker_::track_)");d.a(b,"callback must be valid.","(Tracker_::track_)");d.a("function"===typeof b,"callback must be a function.","(Tracker_::track_)");var c,e;a.hasOwnProperty("VoodooTrackedElementId")?(e=a.VoodooTrackedElementId,c=this.xa[e]):(e=a.VoodooTrackedElementId=this.Vc++,c=this.xa[e]=new ba(a));d.a(c,"TrackedElement not found.","(Tracker_::track_)");
var f=c.wc(b),l=this.Uc++;this.xb[l]={sd:e,rd:c,Ec:f};return l};ga.prototype.dd=function(a){d.a(0<=a,"trackId must be >= 0.",a,"(Tracker_::release_)");d.a("number"===typeof a,"trackId must be a number.",a,"(Tracker_::release_)");var b=this.xb[a],c=b.rd,e=b.sd,b=b.Ec;delete this.xb[a];c.cd(b);0===c.hb&&(delete this.xa[e],delete c.Ea.VoodooTrackedElementId)};ga.prototype.n=function(){for(var a in this.xa)this.xa[a].n()};P.prototype.s=function(){T.va-=this.ib;this.ka=h};P.prototype.A=function(a,b){d.a(b,
"event must be valid.","(Dispatcher_::dispatchEvent_)");var c=this.ka[b.type];if(c)for(var e=0,f=c.length;e<f;++e)c[e].call(a,b)};P.prototype.jb=function(a,b){d.a(a,"type must be valid.","(Dispatcher_::off_)");d.a(b,"listener must be valid.","(Dispatcher_::off_)");d.a("function"===typeof b,"listener must be a function.","(Dispatcher_::off_)");T.Yb(a)&&(T.va--,this.ib--);var c=this.ka[a];c&&c.indexOf(b)&&c.splice(c.indexOf(b),1)};P.prototype.kb=function(a,b){d.a(a,"type must be valid.","(Dispatcher_::on_)");
d.a(b,"listener must be valid.","(Dispatcher_::on_)");d.a("function"===typeof b,"listener must be a function.","(Dispatcher_::on_)");T.Yb(a)&&(T.va++,this.ib++);var c=this.ka[a];c||(c=this.ka[a]=[]);-1===c.indexOf(b)&&c.push(b)};Q.prototype.Ga=function(a){return!!a&&this.l===a.l&&this.Va===a.Va};Q.prototype.l=h;Q.prototype.da=h;Q.prototype.m=h;Q.prototype.Va=-1;Q.prototype.t=h;this.o=function(a,b,c){d.a(a,"type must be valid.","(Event::Event)");this.type=a;this.model=b;this.triggerId="undefined"===
typeof c?-1:c};this.o.prototype.Pc=function(a,b,c,d,f,l){this.page.x=a;this.page.y=b;this.hit.x=c;this.hit.y=d;this.hit.z=f;this.button=l||0};this.o.prototype.button=0;this.o.prototype.hit={};this.o.prototype.hit.x=Number.MAX_VALUE;this.o.prototype.hit.y=Number.MAX_VALUE;this.o.prototype.hit.z=Number.MAX_VALUE;this.o.prototype.model=h;this.o.prototype.object=h;this.o.prototype.page={};this.o.prototype.page.x=Number.MAX_VALUE;this.o.prototype.page.y=Number.MAX_VALUE;this.o.prototype.size={};this.o.prototype.size.x=
Number.MAX_VALUE;this.o.prototype.size.y=Number.MAX_VALUE;this.o.prototype.type=h;this.o.prototype.triggerId=-1;this.Event=this.o;var T={va:0,Yb:function(a){return"mouseup"===a||"mousedown"===a||"click"===a||"dblclick"===a||"mousemove"===a||"mouseover"===a||"mouseout"===a}};X.prototype.add=x();X.prototype.cursor=function(a){this.Nb=a};X.prototype.remove=x();X.prototype.s=x();X.prototype.Nb="auto";ia.prototype.Mb=function(){d.B("createTriggers_() undefined.");return h};ia.prototype.p=h;ja.prototype.Sa=
function(){d.B("raycast_() undefined.");return h};ja.prototype.tb=function(){d.B("setMouse_() undefined.")};G.prototype.xc=function(){var a=this;y.addEventListener("mousemove",function(b){a.Xc(b)},m);y.addEventListener("mousedown",function(b){a.Wc(b)},m);y.addEventListener("mouseup",function(b){a.Yc(b)},m)};G.prototype.s=function(){this.Wb();this.f=h};G.prototype.G=function(a,b,c,d){a=b===h?new f.voodoo.Event(a,h):new f.voodoo.Event(a,b.l,b.Va);a.Pc(this.$a+f.pageXOffset,this.ab+f.pageYOffset,this.bc,
this.cc,this.dc,c);(d||b).l.dispatch(a)};G.prototype.Wb=function(){this.k=h;this.T=[h,h,h];this.aa=[h,h,h];this.yd=m;this.lb=[m,m,m];this.Ra=m;this.dc=this.cc=this.bc=this.ab=this.$a=0;this.ac=[h,h,h];this.Zb=[0,0,0];this.$b=[0,0,0]};G.prototype.Wc=function(a){d.a(a,"event must be valid.","(MouseDetector_::onMouseDown_)");if(this.k!==h){a.preventDefault();var b=a.button,c=this.aa[b],e=new Date-this.ac[b],f=this.T[b]=this.k;this.G("mousedown",this.k,b);f.Ga(c)&&(this.Zb[b]===a.clientX&&this.$b[b]===
a.clientY&&e<=this.f.e.Jc)&&(this.lb[b]=g)}};G.prototype.Xc=function(a){d.a(a,"event must be valid.");this.k!==h&&a.preventDefault();this.$a=a.clientX;this.ab=a.clientY;this.Ra=g;this.f.e.realtime&&this.n()};G.prototype.Yc=function(a){d.a(a,"event must be valid.","(MouseDetector_::onMouseUp_)");var b=a.button;if(this.k){a.preventDefault();this.G("mouseup",this.k,b);var c=this.T[b],e=this.aa[b];c&&this.k!==c&&this.G("mouseup",this.k,b,c);this.k.Ga(c)&&(this.G("click",c,b),this.lb[b]&&c.Ga(e)?(this.aa[b]=
h,this.lb[b]=m,this.G("dblclick",c,b)):(this.aa[b]=c,this.ac[b]=new Date,this.Zb[b]=a.clientX,this.$b[b]=a.clientY))}else(c=this.T[b])&&this.G("mouseup",h,b,c);this.T[b]=h};G.prototype.Sa=function(){var a=this.f.sa.Sa();this.bc=a.Mc;this.cc=a.Nc;this.dc=a.Oc;return a.ya};G.prototype.n=function(){var a=this.f,b=a.sa,a=a.h;this.Ra&&b.tb(new J(this.$a,this.ab));if(!(0>=T.va)){for(var b=this.Sa(),c=0;3>c;++c){var d=this.T[c];d&&b!==d&&this.G("mousemove",b,c,d)}b!==h?(this.Ra&&this.G("mousemove",b),b.Ga(this.k)||
(this.k!==h&&this.G("mouseout",this.k),this.G("mouseover",b)),a.Za(g)):(this.k!==h&&this.G("mouseout",this.k),a.Za(m));this.k=b;this.Ra=m;this.k!==h?a.sb(this.k.m.Nb):a.sb("auto")}};A.prototype=new O;A.prototype.Kb=function(){if(0===this.Ub){var a=f.innerWidth/2,b=f.innerHeight/2;this.c.projectionMatrix.makeOrthographic(-a,a,b,-b,this.L,this.R)}else this.c.projectionMatrix.makePerspective(this.Tb,this.Ab,this.L,this.R)};A.prototype.Ic=function(){var a=this;Object.defineProperty(this,"position",{get:function(){var b=
a.c.position;return{x:b.x,y:b.y,z:b.z}},enumerable:g});Object.defineProperty(this,"zNear",{get:function(){return a.L},enumerable:g});Object.defineProperty(this,"zFar",{get:ea("R"),enumerable:g})};A.prototype.Qc=function(){this.ra=this.mb=this.nb=g;var a=this.c.up;a.x=0;a.y=-1;a.z=0;this.ga();this.n();var b=this;f.addEventListener("scroll",function(){b.qa()},m);f.addEventListener("resize",function(){b.ga()},m);this.I=g};A.prototype.qa=function(){this.nb=g};A.prototype.ga=function(){this.mb=g;this.qa()};
A.prototype.ea=function(a,b){d.a(a,"zNear must be valid.",a,"(ThreeJsCamera_::setZNearAndFar_)");d.a("number"===typeof a,"zNear must be a number.",a,"(ThreeJsCamera_::setZNearAndFar_)");d.a(0<a,"zNear must be greater than 0.",a,"(ThreeJsCamera_::setZNearAndFar_)");d.a(b,"zFar must be valid.",b,"(ThreeJsCamera_::setZNearAndFar_)");d.a("number"===typeof b,"zFar must be a number.",b,"(ThreeJsCamera_::setZNearAndFar_)");d.a(0<b,"zFar must be greater than 0.",b,"(ThreeJsCamera_::setZNearAndFar_)");d.a(a<
b,"zNear must be less than zFar.",a,b,"(ThreeJsCamera_::setZNearAndFar_)");this.L=a;this.R=b;this.Kb();this.ra=g;this.n()};A.prototype.n=function(){if(this.mb){var a=this.Eb.style,b=parseInt(a.width,10),a=parseInt(a.height,10);this.Ab=b/a;var c=this.Ub||30;this.Tb=b>a?c/this.Ab:c;b=Math.tan(this.Tb/360*Math.PI);this.xd=a/2/b;this.Kb();this.c.position.z=this.xd;this.c.scale.x=-1;this.mb=m;this.ra=this.I=g}this.nb&&(a=this.Eb.style,b=parseInt(a.width,10),a=parseInt(a.height,10),c=this.c.position,c.x=
b/2+f.pageXOffset,c.y=a/2+f.pageYOffset,this.c.lookAt(new THREE.Vector3(c.x,c.y,0)),this.nb=m,this.ra=this.I=g);this.ra&&(this.c.updateMatrixWorld(g),b=new THREE.Matrix4,b.getInverse(this.c.matrixWorld),this.eb.setFromMatrix((new THREE.Matrix4).multiplyMatrices(this.c.projectionMatrix,b)),this.ra=m)};A.prototype.c=h;A.prototype.eb=h;A.prototype.I=m;R.prototype=new ja;R.prototype.Qb=function(a,b){d.a(b,"stencilIntersections must be valid","(ThreeJsRaycaster_::findClosestAboveLayerIntersection_)");
for(var c=this.h.X.za.p,e=0,f=c.length;e<f;++e){var l=c[e],k=l.l,n=this.uc.intersectObject(l.da,g);if(!(0>=n.length)){var u=n[0],n=u.distance,u=u.point;if(!(0>=n||n>=a.Da)){var s=this.f.e;if(!s.belowLayer||!(0>u.z&&l.t.below&&s.stencils&&k.viewType!==k.stencilViewType&&-1===b.indexOf(k)))a.Da=n,a.ya=l,a.pb=u}}}return a};R.prototype.Rb=function(a,b){d.a(b,"stencilIntersections must be valid.","(ThreeJsRaycaster_::findClosestBelowLayerIntersection_)");for(var c=this.h.Z.za.p,e=0,f=c.length;e<f;++e){var l=
c[e],k=l.l,n=l.da,u=this.f.e;if(!u.aboveLayer||!k.view.above)if(n=this.Bb.intersectObject(n,g),!(0>=n.length)){var s=n[0],n=s.point,s=s.distance;if(!(0<=n.z)&&!(0>=s||s>=a.Da))if(!u.stencils||!(k.viewType!==k.stencilViewType&&-1===b.indexOf(k)))a.Da=s,a.ya=l,a.pb=n}}return a};R.prototype.Sb=function(){for(var a=[],b=this.h.$.za.p,c=0,d=b.length;c<d;++c){var f=b[c],l=f.da,k=f.l;k.viewType!==k.stencilViewType&&f.t.below&&-1===b.indexOf(k)&&0<this.Bb.intersectObject(l,g).length&&a.push(k)}return a};
R.prototype.Sa=function(){var a={Da:Number.MAX_VALUE,ya:h,pb:h},b=this.f.e,c=b.belowLayer,d=b.aboveLayer;c&&d?(b=b.stencils?this.Sb():[],a=this.Qb(a,b),a=this.Rb(a,b)):d?a=this.Qb(a,[]):c&&(b=this.Sb(),a=this.Rb(a,b));b=a.pb;return{ya:a.ya,Mc:b?b.x:Number.MAX_VALUE,Nc:b?b.y:Number.MAX_VALUE,Oc:b?b.z:Number.MAX_VALUE}};R.prototype.tb=function(a){d.a(a,"mouse must be valid.","(ThreeJsRaycaster_::setMouse_)");var b=this.h.yb,c=2*(a.x/b.width)-1;a=2*-(a.y/b.height)+1;this.f.e.aboveLayer&&(b=this.h.X.c.c,
this.Aa=new THREE.Vector3(c,a,1),this.mc.unprojectVector(this.Aa,b),this.Aa=this.Aa.sub(b.position).normalize(),this.uc=new THREE.Raycaster(b.position,this.Aa));this.f.e.belowLayer&&(b=this.h.Z.c.c,this.Ba=new THREE.Vector3(c,a,1),this.mc.unprojectVector(this.Ba,b),this.Ba=this.Ba.sub(b.position).normalize(),this.Bb=new THREE.Raycaster(b.position,this.Ba))};D.prototype=new B;D.prototype.add=function(a){d.a(a,"object must be valid.","(ThreeJsScene_::add)");a.addedToVoodooTriggers?a.visible=g:this.m.add(a);
a.addedToVoodooScene=g;this.pa.push(a);this.Xb(a)&&this.oa.push(a);this.H=g;var b=new f.voodoo.Event("add");b.object=a;this.d.A(this.t,b)};D.prototype.attach=function(a,b,c,e){d.a(a,"element must be valid.","(ThreeJsScene_::attach)");var r="undefined"!==typeof b?b:g,l="undefined"!==typeof c?c:g,k="undefined"!==typeof e?e:g;this.wa!==h&&this.detach();var n=f.voodoo.Event,u=this;a&&(this.wa=this.fa.qd(a,function(b,c,d,e,f,t){var q=u.m,p=q.position,q=q.scale;r?(p.x=b+d/2,p.y=c+e/2):(p.x=b,p.y=c);l?q.x=
q.y=1:(q.x=d,q.y=e);q.z=k?(q.x+q.y)/2:1;u.m.updateMatrixWorld(g);u.H=g;f&&(f=new n("move"),f.object=a,p=f.page,p.x=b,p.y=c,p=f.size,p.x=d,p.y=e,u.d.A(h,f));t&&(f=new n("resize"),f.object=a,p=f.page,p.x=b,p.y=c,p=f.size,p.x=d,p.y=e,u.d.A(h,f))}),b=new n("attach"),b.object=a,this.d.A(this.t,b))};D.prototype.detach=function(){var a=new f.voodoo.Event("detach");this.d.A(h,a);this.fa.dd(this.wa);this.wa=h;var a=this.m.position,b=this.m.scale;a.x=a.y=0;b.x=b.y=1;this.m.updateMatrixWorld(g)};D.prototype.localToPage=
function(a){d.a(a,"coordinate must be valid.","(ThreeJsScene_::localToPage)");var b=this.m.position,c=this.m.scale;return"undefined"!==typeof a.x?{x:a.x*c.x+b.x,y:a.y*c.y+b.y,z:a.z*c.z+b.z}:[a[0]*c.x+b.x,a[1]*c.y+b.y,a[2]*c.z+b.z]};D.prototype.off=function(a,b){this.d.jb(a,b)};D.prototype.on=function(a,b){this.d.kb(a,b)};D.prototype.pageToLocal=function(a){d.a(a,"coordinate must be valid.","(ThreeJsScene_::pageToLocal)");var b=this.m.position,c=this.m.scale;return"undefined"!==typeof a.x?{x:(a.x-
b.x)/c.x,y:(a.y-b.y)/c.y,z:(a.z-b.z)/c.z}:[(a[0]-b.x)/c.x,(a[1]-b.y)/c.y,(a[2]-b.z)/c.z]};D.prototype.remove=function(a){d.a(a,"object must be valid.","(ThreeJsScene_::remove)");var b=new f.voodoo.Event("remove");b.object=a;this.d.A(this.t,b);a.addedToVoodooTriggers?a.visible=m:this.m.remove(a);a.addedToVoodooScene=m;b=this.pa.indexOf(a);-1!==b&&this.pa.splice(b,1);this.Xb(a)&&(b=this.oa.indexOf(a),-1!==b&&this.oa.splice(b,1));this.H=g};D.prototype.s=function(){this.i.remove(this.m);this.wa!==h&&
this.detach();this.d.s();this.m=this.t=this.i=this.d=h};D.prototype.Xb=function(a){return a instanceof THREE.Mesh||a instanceof THREE.MorphAnimMesh||a instanceof THREE.SkinnedMesh||a instanceof THREE.Line};L.prototype=new $;L.prototype.Lb=function(a){d.a(a,"view must be valid.","(ThreeJsSceneFactory_::createScene_)");return new D(this.i,a)};L.prototype.i=h;ca.prototype=new X;ca.prototype.add=function(a,b){d.a(a,"object must be valid","(ThreeJsTriggers_::add)");for(var c=new Q(this.t,a,this,b),e=0,
f=this.p.length;e<f;++e)this.p[e].da===c.da&&d.B("Trigger already exists");this.p.push(c);a.addedToVoodooScene||(a.visible=m,this.i.add(a));a.addedToVoodooTriggers=g};ca.prototype.remove=function(a){d.a(a,"object must be valid.","(ThreeJsTriggers_::remove)");for(var b=0,c=this.p.length;b<c;++b)this.p[b].da===a&&this.p.splice(b,1);a.addedToVoodooScene&&this.i.remove(a);a.addedToVoodooTriggers=m};ca.prototype.s=function(){this.t=this.i=this.p=h};S.prototype=new ia;S.prototype.Mb=function(a){d.a(a,"view must be valid.",
"(ThreeJsTriggersFactory_::createTriggers_)");return new ca(this.p,a.scene.i,a)};t.prototype=new C;t.prototype.Za=function(a){var b=this.f.e;a?(b.aboveLayer&&(this.S.style.pointerEvents="auto"),b.belowLayer&&(this.M.style.pointerEvents="auto"),b.seamLayer&&(this.P.style.pointerEvents="auto")):(b.aboveLayer&&(this.S.style.pointerEvents="none"),b.belowLayer&&(this.M.style.pointerEvents="none"),b.seamLayer&&(this.P.style.pointerEvents="none"))};t.prototype.Gc=function(){d.j("Creating WebGL renderers");
this.Ya=1;var a=this.f.e,b=a.aboveLayer,c=a.belowLayer,e={antialias:a.antialias,alpha:g};b&&(this.Y=new THREE.WebGLRenderer(e),this.S=this.Y.domElement,this.ub(this.Y),this.S.style.zIndex=a.aboveZIndex);c&&(this.q=new THREE.WebGLRenderer(e),this.M=this.q.domElement,this.ub(this.q),this.M.style.zIndex=a.belowZIndex);b&&this.Y.context.getContextAttributes().antialias||c&&this.q.context.getContextAttributes().antialias||(a.antialias=m,a.seamLayer=m);if(!b||!c)a.seamLayer=m;a.seamLayer&&(this.C=new THREE.WebGLRenderer({antialias:m,
alpha:g}),this.P=this.C.domElement,this.ub(this.C),this.P.style.zIndex=a.seamZIndex);this.ga(m);this.qa(m)};t.prototype.Hc=function(){d.j("Creating layers");var a=this.f.e,b=a.renderer,c=a.fov,e=a.L,k=a.R;a.aboveLayer&&(this.F=new A(this.S,c,e,k),this.zb=new L,this.vc=new S,this.tc=new N,this.X=new z(H.Above,b,this.F,this.zb,this.vc,this.tc),this.ba.push(this.X));a.belowLayer&&(this.v=new A(this.M,c,e,k),this.Cb=new L,this.Dc=new S,this.Ac=new N,this.Z=new z(H.Below,b,this.v,this.Cb,this.Dc,this.Ac),
this.ba.push(this.Z),a.stencils&&(this.D=new A(this.M,c,e,k),this.Xa=new L,this.Cc=new S,this.Bc=new N,this.$=new z(H.BelowStencil,b,this.D,this.Xa,this.Cc,this.Bc),this.ba.push(this.$)));a.seamLayer&&(this.u=new A(this.P,c,e,k),this.rb=new L,this.md=new S,this.hd=new N,this.ta=new z(H.Seam,b,this.u,this.rb,this.md,this.hd),this.ba.push(this.ta),a.stencils&&(this.D||(this.D=new A(this.P,c,e,k)),this.pc=new L,this.ld=new S,this.kd=new N,this.ua=new z(H.SeamStencil,b,this.D,this.pc,this.ld,this.kd),
this.ba.push(this.ua)));this.ob=m;this.sc();var l=this;f.addEventListener("resize",function(){l.ob=g},m)};t.prototype.s=function(){var a=this.f.e,b=y.body;a.aboveLayer&&b.removeChild(this.S);a.belowLayer&&b.removeChild(this.M);a.seamLayer&&b.removeChild(this.P);this.ma.s()};t.prototype.U=function(a){return this.H?g:!a?m:a.U()};t.prototype.ec=function(){this.H=g};t.prototype.ic=function(){this.fb=new Date};t.prototype.ga=function(a){function b(a,b){a.setViewport(0,0,n,q);var c=b.style;c.width=k;c.height=
l;b.width=n;b.height=q}this.ud();var c=this.yb,d=c.width,c=c.height,k=d+"px",l=c+"px",p=f.devicePixelRatio||1,n=d*p*this.Ya,q=c*p*this.Ya,d=this.f.e;d.aboveLayer&&b(this.Y,this.S);d.belowLayer&&b(this.q,this.M);d.seamLayer&&b(this.C,this.P);c=y.body.style;c.display="none";c.display="block";this.H=g;d.realtime&&a&&this.W()};t.prototype.qa=function(a){this.vb=f.pageXOffset+"px";this.wb=f.pageYOffset+"px";this.H=g;this.f.e.realtime&&a&&this.W()};t.prototype.bd=function(){d.j("Registering for window events");
var a=this;f.addEventListener("scroll",function(){a.qa.call(a,g)},m);f.addEventListener("resize",function(){a.ga.call(a,g)},m)};t.prototype.W=function(){var a=m,b=this.f.e,c=b.aboveLayer,e=b.belowLayer,k=b.seamLayer,l=b.stencils,p=b.performanceScaling,n=f.voodoo.debug,q=n.drawStencils,n=n.disableStencils;this.td();this.ma.Lc();p&&!this.kc&&(this.ma.cb>b.Zc||0===this.f.V?this.fb=new Date:(new Date-this.fb)/1E3>b.$c&&(d.j("Enabling performance scaling"),this.Ya=0.5,this.kc=g,this.ga(m)));if(q)l?e&&
this.U(this.$)&&(a=this.q.context,a.disable(a.STENCIL_TEST),this.q.autoClear=g,this.q.render(this.Xa.i,this.v.c),a=g):this.q.clear(),this.Y.clear(),this.C.clear();else{if(e&&(this.U(this.Z)||this.U(this.$)))!l||n?(a=this.q.context,a.disable(a.STENCIL_TEST),this.q.autoClear=g):(a=this.q.context,a.enable(a.STENCIL_TEST),a.clearStencil(0),a.stencilOp(a.REPLACE,a.REPLACE,a.REPLACE),a.stencilFunc(a.NEVER,1,4294967295),this.q.autoClear=m,this.q.clear(),this.q.render(this.Xa.i,this.D.c),a.stencilOp(a.KEEP,
a.KEEP,a.KEEP),a.stencilFunc(a.EQUAL,1,4294967295)),this.q.render(this.Cb.i,this.v.c),a=g;c&&this.U(this.X)&&(this.Y.render(this.zb.i,this.F.c),a=g);if(k&&(this.U(this.ta)||this.U(this.ua)))a=b.jd,e=this.u.position.z,c=e-a,k=e+a,a=this.C.context,a.enable(a.STENCIL_TEST),this.C.autoClear=m,this.C.clear(),!l||n?a.clearStencil(0):(a.clearStencil(1),a.stencilOp(a.REPLACE,a.REPLACE,a.REPLACE),a.stencilFunc(a.NEVER,0,4294967295),this.C.render(this.pc.i,this.D.c),this.u.ea(c,e),this.C.render(this.rb.i,this.u.c)),
l=this.rb.i,n=this.u.c,a.stencilOp(a.REPLACE,a.REPLACE,a.REPLACE),a.stencilFunc(a.NEVER,1,4294967295),this.u.ea(b.L,c),this.C.render(l,n),a.stencilOp(a.KEEP,a.KEEP,a.KEEP),a.stencilFunc(a.NOTEQUAL,1,4294967295),this.u.ea(c,k),this.C.render(l,n),a=g}b.aboveLayer&&(this.Y.context.finish(),l=this.S.style,l.left=this.vb,l.top=this.wb);b.belowLayer&&(this.q.context.finish(),l=this.M.style,l.left=this.vb,l.top=this.wb);b.seamLayer&&(this.C.context.finish(),b=this.P.style,b.left=this.vb,b.top=this.wb);this.H=
m;this.X&&this.X.ja();this.Z&&this.Z.ja();this.$&&this.$.ja();this.ta&&this.ta.ja();this.ua&&this.ua.ja();a&&this.ma&&this.ma.W()};t.prototype.sb=function(a){d.a(a,"cursor must be valid.","(ThreeJsRenderer_::setCursor_)");var b=this.f.e;b.aboveLayer&&(this.S.style.cursor=a);b.belowLayer&&(this.M.style.cursor=a);b.seamLayer&&(this.P.style.cursor=a)};t.prototype.ub=function(a){d.a(a,"canvasRenderer must be valid.","(ThreeJsRenderer_::setupFullscreenCanvasRenderer_)");var b=a.domElement,c=b.style;a.setFaceCulling(THREE.CullFaceFront,
THREE.FrontFaceDirectionCCW);c.position="absolute";c.pointerEvents="none";y.body.appendChild(b)};t.prototype.td=function(){this.F&&this.F.n();this.v&&this.v.n();this.u&&this.u.n();this.D&&this.D.n();this.ob&&(this.sc(),this.ob=m);if(this.F&&this.F.I||this.v&&this.v.I||this.u&&this.u.I||this.D&&this.D.I){for(var a=this.f.K,b=new f.voodoo.Event("cameramove"),c=0,d=a.length;c<d;++c)a[c].dispatch(b);this.F&&(this.F.I=m);this.v&&(this.v.I=m);this.u&&(this.u.I=m);this.D&&(this.D.I=m)}};t.prototype.sc=function(){var a=
this.f.e,b=a.aboveLayer,c=a.belowLayer;if(c)if(b){var d=this.v.position.z;this.v.ea(d-0.5,a.R)}else this.v.ea(a.L,a.R);b&&(c?(d=this.F.position.z,this.F.ea(a.L,d)):this.F.ea(a.L,a.R))};t.prototype.ud=function(){var a=y.createElement("div"),b=y.documentElement;a.style.cssText="position: fixed; top: 0; left: 0; bottom: 0; right: 0;";b.insertBefore(a,b.firstChild);this.yb=new I(a.offsetWidth,a.offsetHeight);b.removeChild(a)};t.prototype.vd=function(){d.j("Validating and preparing webpage for use");d.a(y.body,
"document.body is undefined","(ThreeJsRenderer_::validateAndPrepareWebpage_)");var a=y.body.style;a.width="100%";a.height="100%";a.margin="0px"};t.prototype.ba=h;v.prototype.destroy=function(){d.j("Destroying Engine");this.d.A(h,new f.voodoo.Event("destroy"));-1!==this.Wa&&f.clearInterval(this.Wa);-1!==this.Ua&&f.clearInterval(this.Ua);for(-1!==this.Ta&&f.cancelAnimationFrame(this.Ta);0<this.K.length;)this.K[0].destroy();this.K=h;this.h.s();this.Oa.s();this.d.s();"undefined"!==typeof f.voodoo.engine&&
delete f.voodoo.engine;this.K=this.d=this.Oa=this.h=h;this.Ta=this.Ua=this.Wa=-1;this.fa=this.gb=this.e=h;da=0};v.prototype.frame=function(){this.n();this.h.W()};v.prototype.off=function(a,b){this.d.jb(a,b)};v.prototype.on=function(a,b){this.d.kb(a,b)};v.prototype.models=h;v.prototype.yc=function(a){d.a(a,"model must be valid.","(Engine::addModel_)");this.K.push(a);this.d.A(h,new f.voodoo.Event("addmodel",a))};v.prototype.Vb=function(){return 0!==this.V};v.prototype.fc=function(){this.h.ec()};v.prototype.ed=
function(a){d.a(a,"model must be valid.","(Engine::removeModel_)");this.K.splice(this.K.indexOf(a),1);this.d.A(h,new f.voodoo.Event("removemodel",a))};v.prototype.nc=function(a,b){var c=this;this.Ta=requestAnimationFrame(function(){c.nc(a,b)});this.Vb()&&(a&&this.n(),b&&this.h.W())};v.prototype.nd=function(){d.j("Starting timers.");var a=this;this.la=this.Ia=this.V=0;f.addEventListener("focus",function(){d.j("Window focus acquired. Starting.");a.V=0;a.la=setTimeout(function(){a.V=Date.now();a.la=
0;a.h.ic()},a.e.od)},m);f.addEventListener("blur",function(){d.j("Window lost focus. Pausing.");a.V=0;0!==a.la&&(clearTimeout(a.la),a.la=0)},m);setTimeout(function(){if(!y.hasFocus||y.hasFocus())a.V=Date.now()},a.e.pd)};v.prototype.n=function(){var a=0,b=Date.now();this.Vb()&&(a=(b-this.V)/1E3,this.V=b);a>2*this.Ia?(b=this.Ia,this.Ia=a,a=b):this.Ia=a;this.fa.n();for(var b=this.K,c=0,d=b.length;c<d;++c)b[c].update(a);this.Oa.n()};v.prototype.wd=function(){!this.e.aboveLayer&&!this.e.belowLayer&&d.B("At least one layer must be enabled.",
"(Engine::validateOptions_)")};v.prototype.Oa=h;v.prototype.gb=h;v.prototype.e=h;v.prototype.sa=h;v.prototype.h=h;this.engine=v.prototype.fa=h;this.Engine=v;this.version=h;k.prototype.aboveLayer=g;k.prototype.aboveZIndex=9999;k.prototype.antialias=g;k.prototype.belowLayer=g;k.prototype.belowZIndex=-1;k.prototype.Jc=500;k.prototype.fov=30;k.prototype.frameLoop=g;k.prototype.performanceScaling=g;k.prototype.Zc=45;k.prototype.$c=3;k.prototype.realtime=g;k.prototype.renderer=E.ThreeJs;k.prototype.renderInterval=
0;k.prototype.jd=10;k.prototype.seamLayer=g;k.prototype.seamZIndex=1E4;k.prototype.standardLighting=g;k.prototype.stencils=g;k.prototype.od=350;k.prototype.pd=1E3;k.prototype.updateInterval=0;k.prototype.R=1E4;k.prototype.L=0.1;this.Options=k;var U=p.extend();U.prototype.createLight=function(){d.B("createLight_() undefined.");return h};U.prototype.load=function(){d.a(this.renderer===E.ThreeJs,"Only ThreeJs is supported.","(LightView_::load)");this.na=this.createLight();d.a(this.na,"light must be valid.");
this.scene.add(this.na)};U.prototype.unload=function(){d.a(this.renderer===E.ThreeJs,"Only ThreeJs is supported.","(LightView_::unload)");this.scene.remove(this.na)};U.prototype.setColor=function(a){d.a(this.renderer===E.ThreeJs,"Only ThreeJs is supported.","(LightView_::setColor)");a=f.voodoo.utility.convertCssColorToThreeJsColor(a);this.na.color.copy(a)};var Y=q.extend();Y.prototype.initialize=function(a){this.Ca=a.color||"white";var b=this;Object.defineProperty(this,"color",{get:function(){return b.Ca},
set:function(a){b.view.setColor(a);b.Ca=a}})};Y.prototype.setUpViews=function(){this.color=this.Ca?this.Ca:"black"};Y.prototype.color=h;Y.prototype.stencilViewType=p.extend();var V=U.extend();V.prototype.createLight=function(){d.a(this.renderer===E.ThreeJs,"Only ThreeJs is supported.","(AmbientLightView_::AmbientLightView_)");return new THREE.AmbientLight};var ka=Y.extend();ka.prototype.name="AmbientLight";ka.prototype.viewType=V;V=U.extend();V.prototype.createLight=function(){d.a(this.renderer===
E.ThreeJs,"Only ThreeJs is supported.","(CameraLightView_::CameraLightView_)");return new THREE.PointLight};V.prototype.load=function(){U.prototype.load.apply(this);this.updatePosition()};V.prototype.updatePosition=function(){d.a(this.renderer===E.ThreeJs,"Only ThreeJs is supported.","(CameraLightView_::updatePosition)");var a=this.na.position,b=this.camera.position;a.x=b.x;a.y=b.y;a.z=b.z};var ha=Y.extend();ha.prototype.name="CameraLight";ha.prototype.viewType=V;ha.prototype.setUpViews=function(){this.on("cameramove",
function(){this.view.updatePosition()})}}for(var w=["voodoo"],I=f,J=0;J<w.length-1;++J)I=I[w[J]];if(I[w[w.length-1]]){var J=I[w[w.length-1]],da=new $,Z;for(Z in da)J[Z]=da[Z]}else I[w[w.length-1]]=new $;I[w[w.length-1]].version="0.9.0.min"})(window,document,void 0);
